0) сохранить несколько протоколов синтеза для верификации данных после ускорения
1) узкое горлышко - переписать через numpy матричные вычисления
2) посмотреть на профилировку новую
3) 